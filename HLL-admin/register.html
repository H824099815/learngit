<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8"> 
		<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
		<title>注册</title>
		<link rel="stylesheet" href="css/reset.css">
		<link rel="stylesheet" href="layui/css/layui.css">
		<link rel="stylesheet" href="css/public.css">
		<link rel="stylesheet" href="font-awesome-4.7.0/css/font-awesome.css">
		<style>
			.content {
				position: absolute;
				top: 50%;
				left: 50%;
				transform: translate(-50%,-50%);
				width: 400px;
				text-align: center;
			}
			.logo {
				width: 130px;
				margin-bottom: 50px;
			}
			.button-wrapper {
				text-align: center;
				margin: 50px 0;
			}
			.button-wrapper>button {
				margin: 0 20px;
			}
			.layui-form-item>label {
				padding: 9px 0;
			}
			
			.layui-inline>label {
				padding: 9px 0;
			}
			.layui-input-block {
				margin-left: 80px;
			}
			.bottom-wrapper {
				text-align: right;
			}
			.bottom-wrapper>* {
				display: inline-block;
			}
			.bottom-wrapper>a {
				margin-right: 20px;
				color: #409eff;
			}
			.layui-layer-content {
				line-height: 100px;
				text-align: center;
			}
		</style>
	</head>
	<body>
	<!-- *@author 侯成昊
		*@company 豆趣（山东）科技有限公司
		*@E-mail 824099815@qq.com
		*@QQ 824099815
	-->
	
		<div class="content">
			<img src="images/logo.png" alt="" class="logo">
			<form class="layui-form" action="" lay-filter="registerForm">
				<div class="layui-form-item">
					<label class="layui-form-label">账号：</label>
					<div class="layui-input-block" >
						<input type="text" name="account" lay-verify="required" lay-reqtext="账号不能为空" placeholder="请输入账号" autocomplete="off" class="layui-input">
					</div>
				</div>
				<div class="layui-form-item">
					<label class="layui-form-label">姓名：</label>
					<div class="layui-input-block" >
						<input type="text" name="nick" lay-verify="required" lay-reqtext="姓名不能为空" placeholder="请输入姓名" autocomplete="off" class="layui-input">
					</div>
				</div>
				<div class="layui-form-item">
					<label class="layui-form-label">手机号：</label>
					<div class="layui-input-block" >
						<input type="tel" maxlength="11"  name="phone" lay-verify="required|phone" lay-reqtext="手机号不能为空" placeholder="请输入手机号" autocomplete="off" class="layui-input">
					</div>
				</div>
				<div class="layui-form-item">
					<label class="layui-form-label">密码：</label>
					<div class="layui-input-block" >
						<input type="text" name="pwd" id="pwd" lay-verify="pass" lay-reqtext="密码不能为空" placeholder="请输入密码" autocomplete="off" class="layui-input">
					</div>
				</div>
				<div class="layui-form-item">
					<label class="layui-form-label">确认密码：</label>
					<div class="layui-input-block" >
						<input type="text" name="pwd2" lay-verify="repass" lay-reqtext="请确认密码" placeholder="请确认密码" autocomplete="off" class="layui-input">
					</div>
				</div>
				
				
				<div class="layui-form-item bottom-wrapper">
					<label class="layui-form-label"></label>
					<p>已有账号？</p>
					<a href="login.html" class="register">请登录>>></a>
				</div>
				<div class="layui-form-item">
					<div class="layui-input-block button-wrapper">
						<button type="submit" class="layui-btn layui-bg-blue" lay-submit="" lay-filter="registerBtn">立即注册</button>
						<button type="reset" class="layui-btn layui-btn-primary">重置</button>
					</div>
				</div>
					
			</form>
		</div>
		
		<script src="js/jQuery-3.4.0.js"></script>
		<script src="layui/layui.js"></script>
		<script src="js/jquery.cookie.js"></script>
		<script>
			layui.use(['element','laypage','layer','form','laydate','table'], function() {
				var $ = layui.jquery,
				element = layui.element,
				form = layui.form,
				layer = layui.layer;
				
				
				form.verify({ 
					pass: [/(.+){6,12}$/, '密码必须6到12位'],
					repass: function(value){
						var repassvalue = $('#pwd').val();
						console.log(repassvalue);
						if(value != parseInt(repassvalue)){
						return '两次输入的密码不一致!';
						}
					}
				});
				
				//登录
				form.on('submit(registerBtn)', function(data){
					var getVal = form.val("registerForm");
					var d = new Date();
					var registerTime = d.getTime();
					//生成唯一ID
					function getID(length){
						return Number(Math.random().toString().substr(3,length));
					};
					var sendData = {
							accountId: parseInt(getID(9)),
							loginName: getVal.account,
							password: getVal.pwd,
							nick: getVal.nick,
							authority: "admin",
							avatar: "https://wpimg.wallstcn.com/f778738c-e4f8-4870-b634-56703b4acafe.gif",
							phone: getVal.phone,
							address: "山东济南",
							registerTime: registerTime
						}
						$.ajax({
							type: 'post',
							dataType: 'json',
							contentType: 'application/json',
							data: JSON.stringify(sendData),
							url: 'http://192.168.1.248:4675/acc/register',
							headers: {
										"X-Token": $.cookie('token')
							},
							success: function(result) {
								if(result.msg !== ''){
									alert(result.msg);
								} else {
									layer.open({
										type: 1,
											closeBtn: 0, //不显示关闭按钮
											anim: 2,
										area: ['300px', '200px'],
										shadeClose: false, //开启遮罩关闭
										content: '注册成功',
										btn: ['登录'],
										yes: function(index, layero){
											window.location = "login.html"
										}
									});
								}
									
							}
						});
						return false;
				});
				
			
			
			});
		</script>
	</body>
</html>
